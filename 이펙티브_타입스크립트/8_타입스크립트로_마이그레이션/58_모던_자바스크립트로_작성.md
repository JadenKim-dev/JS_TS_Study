# 58. 모던 자바스크립트로 작성하기

옛날 버전의 자바스크립트 코드를 최신 버전으로 변경하는 것은 타입스크립트로 전환하는 과정의 일부라고 볼 수 있다.  
타입스크립트 컴파일러는 최신 버전의 자바스크립트 코드를 예전 버전의 자바스크립트로 변환할 수 있다.  
따라서 예전 버전의 코드를 타입스크립트 컴파일러에서도 동작하도록 최신 버전으로 바꾸는 작업이 필요하다.

## ECMAScript 모듈 사용하기

먼저 고려해야 할 것은 import와 export 기반의 ECMAScript 모듈로 전환하는 것이다.  
과거에 생성된 다양한 비표준 모듈 방식을 ECMAScript 모듈 형식으로 변경하고, 필요하다면 웹팩이나 ts-node 등의 도구를 이용하여 모듈 시스템이 정상 작동하도록 컴파일 할 수 있다.  
다음은 CommonJS 모듈 시스템을 ECMAScript 모듈 방식으로 전환하는 예시이다.

```ts
// CommonJS
// a.js
const b = require('./b');
console.log(b.name);

// b.js
const name = 'Module B’;
module.exports = {name};

// ECMAScript module
// a.ts
import * as b from './b';
console.log(b.name);

// b.ts
export const name = 'Module B';
```

## 프로토타입 대신 클래스 사용하기

과거에는 자바스크립트에서 프로토타입 기반의 객체 모델을 사용했으나, ES2015 부터는 클래스 기반 모델이 도입되었다.  
클래스로 구현했을 때 문법이 더 간결하고 직관적으로 바뀌게 때문에, 기존에 프로토타입을 사용하는 객체 모델이 있다면 클래스 기반으로 전환하는게 좋다.  
타입스크립트 언어 서비스를 이용하면 '함수를 ES2015 클래스로 변환' 기능을 사용할 수도 있다.

```ts
// 프로토타입
function Person(first, last) {
  this.first = first;
  this.last = last;
}

Person.prototype.getName = function () {
  return this.first + " " + this.last;
};

const marie = new Person("Marie", "Curie");
const personName = marie.getName();
```

```ts
// 클래스
class Person {
  first: string;
  last: string;

  constructor(first: string, last: string) {
    this.first = first;
    this.last = last;
  }

  getName() {
    return this.first + " " + this.last;
  }
}

const marie = new Person("Marie", "Curie");
const personName = marie.getName();
```

## var 대신 let/const 사용하기

자바스크립트의 var를 사용하면 직관적이지 않은 스코프 규칙이 적용된다.  
그 대신 let, const를 사용하면 일반적인 스코프 규칙이 지켜지기 때문에 가능하면 var를 let/const로 대체하는 것이 좋다.  
let/const로 전환 시 일부 타입 오류가 발생할 수 있는데, 이는 보통 잠재적으로 스코프 문제가 존재하는 코드라는 의미이기 때문에 수정하는 것이 좋다.

비슷한 이유로 함수 표현식도 가능하면 지양하는 것이 좋다.  
함수 표현식은 호이스팅 되어 가장 먼저 수행되기 때문에 함수의 정의가 호출보다 뒤에 위치할 수 있다.

```ts
function foo() {
  bar();
  function bar() {
    console.log("hello1");
  }
}
```

이러한 문법도 마찬가지로 직관적이지 않기 때문에, 가능하면 화살표 함수로 전환하여 호이스팅 문제를 피하는 것이 좋다.

## for(;;) 대신 for-of 또는 배열 메서드 사용하기

자바스크립트에서 배열을 순회할 떄 예전에는 C 스타일의 인덱스 기반 루프를 사용했다.  
하지만 최신 버전에는 for - of 루프를 사용하여 인덱스 변수 없이 순회하는 것이 더 간결하다.  
인덱스 변수가 반드시 필요하다면 forEach 메서드를 사용할 수도 있다.

```ts
// 인덱스 기반 루프
for (var i = 0; i < array, length; i++) {
  const el = array[i];
  // ...
}

// for - of
for (const el of array) {
  // ...
}

// forEach
array.forEach((el, i) => {
  // ...
});
```

## 함수 표현식보다 화살표 함수 사용하기
